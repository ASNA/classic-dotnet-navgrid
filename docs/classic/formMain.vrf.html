<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>formMain.vrf.annotated</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>formMain.vrf.annotated</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p><a href="https://github.com/ASNA/classic-dotnet-navgrid">Return to repo</a></p>
<h3>AVR Classic program to demonstrate a simple subfile for customer selection.</h3>
<hr />
<p><img alt="" src="screen-shot-01.png?4" /></p>
<p>This program shows a simple page-at-a-time subfile that would be used 
for navigation through a file. Once a row is located, the user would initiate 
an action. That action isn't show in the is example; this example focuses on 
populating and navigating the subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <hr />
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p><a href="http://1clickurls.com/yT1m-Mq">See file schema here.</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclDiskFile</span>  <span class="nx">Name</span><span class="p">(</span><span class="nx">Cust</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">INPUT</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Org</span><span class="p">(</span><span class="o">*</span><span class="nx">INDEXED</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">Prefix</span><span class="p">(</span><span class="nx">Cust_</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">NetBlockFactor</span><span class="p">(</span><span class="o">*</span><span class="nx">Calc</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">ImpOpen</span><span class="p">(</span><span class="o">*</span><span class="nx">Yes</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">AddRec</span><span class="p">(</span><span class="o">*</span><span class="nx">No</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">FileDesc</span><span class="p">(</span><span class="s1">&#39;Examples/CMastNewL2&#39;</span><span class="p">)</span> <span class="o">+</span>
             <span class="nx">DBDesc</span><span class="p">(</span><span class="s1">&#39;*PUBLIC/DG NET Local&#39;</span><span class="p">)</span> 

<span class="c1">// These data structures aren&#39;t used in this program, but provide a </span>
<span class="c1">// potential discussion point.  </span>
<span class="c1">// DclDS CustDS  ExtDesc(*Yes) +</span>
<span class="c1">//               FileDesc(&#39;Examples/CMastNewL2&#39;) +</span>
<span class="c1">//               DBDesc(&#39;*PUBLIC/DG NET Local&#39;) +</span>
<span class="c1">//               Prefix(Cust_)</span>
 
<span class="c1">// DclDS sbfCustDS  ExtDesc(*Yes) +</span>
<span class="c1">//                  FileDesc(&#39;Examples/CMastNewL2&#39;) +</span>
<span class="c1">//                  DBDesc(&#39;*PUBLIC/DG NET Local&#39;) +</span>
<span class="c1">//                 Prefix(SbfCust_)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>This value controls how many rows are presented
in the subfile.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">DclConst</span> <span class="nx">SUBFILE_ROWS</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
 
<span class="nx">labelName</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="nx">labelAddress</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="nx">labelCSZ</span><span class="p">.</span><span class="nx">Caption</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="nx">sbfCust_ShowFirstPage</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>End of mainline.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>First page requested.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageFirstPage</span> <span class="nx">Click</span>
    <span class="nx">sbfCust_ShowFirstPage</span><span class="p">()</span> 
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Next page requested.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageNextPage</span> <span class="nx">Click</span>
    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span><span class="p">)</span>
    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> 
    <span class="nx">sbfCust_ShowNextPage</span><span class="p">()</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Previous page requested. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imagePreviousPage</span> <span class="nx">Click</span>   
    <span class="nx">sbfCust_ShowPreviousPage</span><span class="p">()</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Last page requested.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">imageLastPage</span> <span class="nx">Click</span>
    <span class="nx">sbfCust_ShowLastPage</span><span class="p">()</span>  
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Watch for ENTER key in the textboxPositionTo textbox. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">textboxPositionTo</span> <span class="nx">KeyPress</span>
    <span class="nx">DclSrParm</span> <span class="nx">KeyAscii</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nx">BY</span><span class="p">(</span><span class="o">*</span><span class="nx">REFERENCE</span><span class="p">)</span>
 
    <span class="nx">DclConst</span> <span class="nx">ENTER_KEY</span> <span class="nx">Value</span><span class="p">(</span> <span class="mi">13</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">EAT_KEY</span>   <span class="nx">Value</span><span class="p">(</span>  <span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Watch for an Enter keypress when ioPosition has 
focus. End the keypress event handler by setting 
KeyAscii to EAT_KEY (0) and then position the subfile.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">ENTER_KEY</span><span class="p">)</span>
        <span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">EAT_KEY</span>
        <span class="nx">sbfCust_PositionTo</span><span class="p">(</span><span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>
        <span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">Value</span> <span class="o">=</span> <span class="o">*</span><span class="nx">Blanks</span>
    <span class="nx">EndIf</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>The current row changed in the subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust</span> <span class="nx">RecSwitch</span>
    <span class="nx">DclSrParm</span> <span class="nx">FromRec</span>  <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Read subfile record on every subfile record switch to have
that subfile row's fields available.  The AVR Classic subfile reports 
zero-based row and column values, and the subfile RRN is one based. 
When chaining to the subfile with the subfile Row property, be sure to add 
one to it to 'translate' it to the corresponding RRN.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">NotFnd</span><span class="p">(</span><span class="o">*</span><span class="nx">In50</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Populate customer info panel with fields from the 
just-read subfile row. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_SetInfoDisplay</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>This subfile event handler fires as the subfile row is changing.
The subfile heading is a considered a row, just like the data rows. 
The subfile heading row's ordinal position is -1 and the first data row 
is zero. If the user moves the current row the entire subfile is 
selected and that is very jarring to the user. This code looks to see 
if the user attempted to move into the header and moves the row 
selected back to the twop row (the zeroth row).</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust</span> <span class="nx">SelChanging</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Inhibit user moving to heading row of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">DclConst</span>  <span class="nx">HEADING_ROW</span>   <span class="nx">Value</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Uncomment this LeaveSr and user move the row to the top of the 
subfile with the <code>up</code> arrow key to see the default behavior arrow
key behavior.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Row</span> <span class="o">=</span> <span class="nx">HEADING_ROW</span><span class="p">)</span>
        <span class="nx">sbfCust_GoToTopRow</span><span class="p">()</span>
    <span class="nx">EndIf</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Clear the subfile and set its RRN to zero--making it ready for a 
a new page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_Initialize</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Initialize and clear subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_RRN</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">ClearObj</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Set the first and previous page buttons' enabled status. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetLeftButtonsStatus</span>
    <span class="nx">DclSrParm</span> <span class="nx">Enabled</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>AVR Classic doesn't have an image button. This program uses the 
image control to simulate image buttons. This is a little extra
work because you need enabled and disabled images, but it 
removes dependence on a third-party button control. See the 
note at the bottom of this page to read about a way to create images
for this purpose.     </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">If</span> <span class="p">(</span><span class="nx">Enabled</span><span class="p">)</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-end-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageFirstPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imagePreviousPage</span><span class="p">)</span> 
        <span class="nx">imageFirstPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">imagePreviousPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-end-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageFirstPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;left-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imagePreviousPage</span><span class="p">)</span> 
        <span class="nx">imageFirstPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
        <span class="nx">imagePreviousPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
    <span class="nx">EndIf</span>  
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Set next and last page buttons' enabled status. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetRightButtonsStatus</span>
    <span class="nx">DclSrParm</span> <span class="nx">Enabled</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    
    <span class="nx">If</span> <span class="p">(</span><span class="nx">Enabled</span><span class="p">)</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-end-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageLastPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-arrow.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageNextPage</span><span class="p">)</span> 
        <span class="nx">imageLastPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span>
        <span class="nx">imageNextPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span>
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-end-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageLastPage</span><span class="p">)</span> 
        <span class="nx">LoadPicture</span> <span class="nx">File</span><span class="p">(</span><span class="s1">&#39;right-arrow-disabled.jpg&#39;</span><span class="p">)</span> <span class="nx">target</span><span class="p">(</span><span class="nx">imageNextPage</span><span class="p">)</span> 
        <span class="nx">imageLastPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span>
        <span class="nx">imageNextPage</span><span class="p">.</span><span class="nx">Enabled</span> <span class="o">=</span> <span class="o">*</span><span class="nx">False</span> 
    <span class="nx">EndIf</span>  
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Show first page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowFirstPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>Position file at top of file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="o">*</span><span class="nx">Start</span><span class="p">)</span> 
    <span class="nx">sbfCust_ShowNextPage</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>Show next page of subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowNextPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>Fill sbfCust with next group of rows from Cust's current 
file pointer position.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_Initialize</span><span class="p">()</span>

    <span class="nx">Do</span> <span class="nx">FromVal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="nx">ToVal</span><span class="p">(</span><span class="nx">SUBFILE_ROWS</span><span class="p">)</span>
        <span class="nx">Read</span> <span class="nx">Cust</span>
        <span class="nx">If</span> <span class="p">(</span><span class="o">%</span><span class="nx">EOF</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span>
            <span class="nx">Leave</span>
        <span class="nx">EndIf</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>Assign fields from the Cust file to the 
subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_RRN</span> <span class="o">=</span> <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nx">sbfCust_CMName</span> <span class="o">=</span> <span class="nx">Cust_CMName</span>
        <span class="nx">sbfCust_CMAddr1</span> <span class="o">=</span> <span class="nx">Cust_CMAddr1</span>
        <span class="nx">sbfCust_CMCity</span> <span class="o">=</span> <span class="nx">Cust_CMCity</span>
        <span class="nx">sbfCust_CMState</span> <span class="o">=</span> <span class="nx">Cust_CMState</span>
        <span class="nx">sbfCust_CMPostCode</span> <span class="o">=</span> <span class="nx">Cust_CMPostCode</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Write the subfile row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">Write</span> <span class="nx">sbfCust</span>

        <span class="nx">SetRowColor</span><span class="p">(</span><span class="nx">sbfCust_RRN</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nx">EndDo</span>

    <span class="nx">SetLeftButtonsStatus</span><span class="p">(</span><span class="nx">MoreRecordsBack</span><span class="p">())</span>
    <span class="nx">SetRightButtonsStatus</span><span class="p">(</span><span class="nx">MoreRecordsForward</span><span class="p">())</span>
    <span class="nx">sbfCust_GoToTopRow</span><span class="p">()</span>    
    <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>Show previous page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowPreviousPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Read the first row of the subfile to make that row's fields available.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Position the file at the record in the first row.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Read backwards from there. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">ReadCustOnePageBackwards</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>Having read backwards a number of rows and then 
show the page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowNextPage</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Show last page of subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_ShowLastPage</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Position file pointer at end of file.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetGT</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="o">*</span><span class="nx">HiVal</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>Read backwards from there. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">ReadCustOnePageBackwards</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>Having read backwards a number of rows and then 
show the page. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">sbfCust_ShowNextPage</span><span class="p">()</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>Every page (first, previous, next, and last) are displayed 
with the sbfCust_ShowNextPage routine. To page through the 
file backwards, this routine reads backwards through the file 
SUBFILE_ROWS + 1 rows. It does this to position the file 
pointer so that sbfCust_ShowNextPage displays the correct page.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">ReadCustOnePageBackwards</span>
    <span class="nx">DclFld</span> <span class="nx">BegOfFile</span>  <span class="nx">Type</span><span class="p">(</span> <span class="o">*</span><span class="nb">Boolean</span> <span class="p">)</span>

    <span class="nx">Do</span> <span class="nx">FromVal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="nx">ToVal</span><span class="p">(</span><span class="nx">SUBFILE_ROWS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nx">ReadP</span> <span class="nx">Cust</span> <span class="nx">BOF</span><span class="p">(</span><span class="nx">BegOfFile</span><span class="p">)</span>
        <span class="nx">If</span> <span class="nx">BegOfFile</span>
            <span class="nx">Leave</span>
        <span class="nx">EndIf</span>
    <span class="nx">EndDo</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Position populated subfile at top row (the zeroth row). </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_GoToTopRow</span>
    <span class="nx">DclConst</span> <span class="nx">TOP_ROW</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LEFT_MOST_COLUMN</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>The Select method selects the given row of the subfile. 
If there are no rows in the subfile, the Select method
fails. Wrapping it an Eval statement and using 
Err(*Extended) 'eats' the error letting Select method 
fail silently. 
You need to provide a zero-based row and column to the 
Select method. Zero is the top row and zero is the left-most 
column. Constants are used to avoid using "magic numbers" 
that be confusing later. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">Eval</span> <span class="nx">F2</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">Select</span><span class="p">(</span><span class="nx">TOP_ROW</span><span class="p">,</span> <span class="nx">LEFT_MOST_COLUMN</span><span class="p">))</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Position subfile at a new location. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">sbfCust_PositionTo</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">PositionToValue</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span>
    <span class="nx">DclFld</span> <span class="nx">SaveName</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Is position-to value key in the file</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">PositionToValue</span><span class="p">)</span>
    <span class="nx">If</span> <span class="p">(</span><span class="o">%</span><span class="nx">FOUND</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>If so, show the next page from there.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_ShowNextPage</span><span class="p">()</span>        
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">True</span> 
    <span class="nx">Else</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Otherwise, reselect the subfile's top row and 
display a message. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">sbfCust_GoToTopRow</span><span class="p">()</span>        
        <span class="nx">MsgBox</span> <span class="nx">Title</span><span class="p">(</span><span class="s1">&#39;Search results&#39;</span><span class="p">)</span> <span class="nx">Msg</span><span class="p">(</span><span class="s1">&#39;No records found&#39;</span><span class="p">)</span>
        <span class="nx">textboxPositionTo</span><span class="p">.</span><span class="nx">SetFocus</span><span class="p">()</span>
        <span class="nx">LeaveSr</span> <span class="o">*</span><span class="nx">False</span> 
    <span class="nx">EndIf</span>
<span class="nx">EndFunc</span> 

<span class="nx">BegSr</span> <span class="nx">sbfCust_SetFields</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Move fields from disk file to subfile.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Assign field values for customer info panel 
above the subfile. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">sbfCust_SetInfoDisplay</span>
    
    <span class="nx">labelName</span><span class="p">.</span><span class="nx">Caption</span>      <span class="o">=</span> <span class="nx">sbfCust_CMName</span>
    <span class="nx">labelAddress</span><span class="p">.</span><span class="nx">Caption</span>   <span class="o">=</span> <span class="nx">sbfCust_CMAddr1</span>
    <span class="nx">labelCSZ</span><span class="p">.</span><span class="nx">Caption</span>       <span class="o">=</span> <span class="o">%</span><span class="nx">TRIM</span><span class="p">(</span><span class="nx">sbfCust_CMCity</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">++</span>
                             <span class="nx">sbfCust_CMState</span> <span class="o">+</span> <span class="s1">&#39;  &#39;</span> <span class="o">++</span>
                             <span class="nx">sbfCust_CMPostCode</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>Set subfile row color.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegSr</span> <span class="nx">SetRowColor</span> 
    <span class="nx">DclSrParm</span> <span class="nx">CurrentRow</span>   <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="nx">If</span> <span class="nx">IsEven</span><span class="p">(</span><span class="nx">CurrentRow</span><span class="p">)</span>
        <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecBackColor</span><span class="p">[</span><span class="nx">CurrentRow</span><span class="p">]</span> <span class="o">=</span> <span class="nx">labelEvenRowColor</span><span class="p">.</span><span class="nx">BackColor</span>
    <span class="nx">Else</span>
        <span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RecBackColor</span><span class="p">[</span><span class="nx">CurrentRow</span><span class="p">]</span> <span class="o">=</span> <span class="nx">labelOddRowColor</span><span class="p">.</span><span class="nx">BackColor</span>
    <span class="nx">EndIf</span>
<span class="nx">EndSr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Return remainder of integer division.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">IsEven</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">DclSrParm</span> <span class="nx">Value</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Integer</span><span class="p">)</span> <span class="nx">Len</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> 

    <span class="nx">DclConst</span> <span class="nx">EVEN_DIVISOR</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> 

    <span class="nx">LeaveSr</span> <span class="nx">Value</span><span class="p">(</span><span class="o">%</span><span class="nx">REM</span><span class="p">(</span><span class="nx">Value</span><span class="p">,</span> <span class="nx">EVEN_DIVISOR</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Return true if there are more records backward, given the 
key value on the first row displayed. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">MoreRecordsBack</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  
    <span class="nx">SetLL</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> 
    <span class="nx">ReadP</span> <span class="nx">Cust</span> <span class="nx">Err</span><span class="p">(</span><span class="o">*</span><span class="nx">Extended</span><span class="p">)</span> 
   
    <span class="nx">LeaveSr</span> <span class="nx">Value</span><span class="p">(</span><span class="nx">NOT</span> <span class="o">%</span><span class="nx">EOF</span><span class="p">(</span><span class="nx">Cust</span><span class="p">))</span> 
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      <p>Return true if there are more records forward, given the 
key value on the last row displayed. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BegFunc</span> <span class="nx">MoreRecordsForward</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nx">Ind</span><span class="p">)</span> 
    <span class="nx">Chain</span> <span class="nx">sbfCust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust</span><span class="p">.</span><span class="nx">RowCount</span><span class="p">)</span>  
    <span class="nx">SetGT</span> <span class="nx">Cust</span> <span class="nx">Key</span><span class="p">(</span><span class="nx">sbfCust_CMName</span><span class="p">)</span> 
    <span class="nx">LeaveSr</span> <span class="o">%</span><span class="nx">Found</span><span class="p">(</span><span class="nx">Cust</span><span class="p">)</span> 
<span class="nx">EndFunc</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Poll for 'f', 'p', 'n', and 'l' keypresses to behave as accelerator keys 
for the corresponding subfile page actions. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nx">BEGSR</span> <span class="nx">sbfCust</span> <span class="nx">KeyPress</span>
    <span class="nx">DclSrParm</span> <span class="nx">KeyAscii</span> <span class="nx">TYPE</span><span class="p">(</span><span class="o">*</span><span class="nx">INTEGER</span><span class="p">)</span> <span class="nx">LEN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nx">BY</span><span class="p">(</span><span class="o">*</span><span class="nx">REFERENCE</span><span class="p">)</span>
    
    <span class="nx">DclConst</span> <span class="nx">LOWER_F_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_N_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">110</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_P_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">112</span><span class="p">)</span>
    <span class="nx">DclConst</span> <span class="nx">LOWER_L_KEY</span> <span class="nx">Value</span><span class="p">(</span><span class="mi">108</span><span class="p">)</span>

    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_F_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowFirstPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_P_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowPreviousPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_N_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowNextPage</span><span class="p">)</span> 
    <span class="nx">Case</span> <span class="nx">Cond</span><span class="p">(</span><span class="nx">KeyAscii</span> <span class="o">=</span> <span class="nx">LOWER_L_KEY</span><span class="p">)</span> <span class="nx">Sr</span><span class="p">(</span><span class="nx">sbfCust_ShowLastPage</span><span class="p">)</span> 
    <span class="nx">EndCs</span>
<span class="nx">ENDSR</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <h3>Creating images for AVR class'c image control.</h3>
<p>The <a href="https://fontawesome.com/icons">FontAwesome</a> site provides free SVG 
images for Web development. SVG images aren't much help to AVR Classic, 
but the <a href="http://fa2png.io/">fa2png</a> site freely translates a FontAwesome
SVG to a PNG. Create a 32px PNG with the fa2png site, then use MS Paint 
to save that PNG as a JPG. (AVR Classic's Image control doesn't work with 
PNG files. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
